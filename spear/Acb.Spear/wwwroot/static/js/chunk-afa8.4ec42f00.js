(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-afa8"],{HKMo:function(e,t,n){"use strict";n.r(t);var o=n("EJiy"),i=n.n(o),s=n("t3Un"),c=function(e,t){return"default"===t?"/api/config/"+e:"/api/config/"+e+"/"+t},a=n("3PWe"),l=n.n(a),r=(n("YBQ+"),{name:"Config",data:function(){return{envs:["default","dev","test","ready","prod"],modes:["text","code","tree","view","form"],configMode:"view",configEnv:"default",list:[],configKey:"",config:"",editor:!1}},computed:{saveStatus:function(){return this.configKey&&this.configKey.length>1},deleteStatus:function(){return this.configKey&&this.configKey.length>1}},created:function(){this.loadList()},mounted:function(){this.editor=new l.a(document.getElementById("jsoneditor"),{mode:this.configMode,search:!0,height:500})},methods:{loadList:function(){var e=this;s.a.get("/api/config/list").then(function(t){e.list=t.data})},loadConfig:function(){var e=this;this.configKey&&function(e,t){return s.a.get("/config/"+e+"/"+t)}(this.configKey,this.configEnv).then(function(t){e.editor.set(t||{}),"tree"!==e.configMode&&"view"!==e.configMode&&"form"!==e.configMode||e.editor.expandAll()})},selectKey:function(e){this.configKey=e,this.loadConfig()},envChange:function(e){this.loadConfig()},modeChange:function(){this.editor.setMode(this.configMode)},save:function(){var e,t=this;this.config=this.editor.getText()||"{}";try{e=JSON.parse(this.config)}catch(e){console.log(e)}if("object"!==(void 0===e?"undefined":i()(e)))return this.$message({message:"配置信息必须为Json格式",type:"warning"}),!1;this.isLoading=!0,function(e,t,n){return s.a.post(c(e,t),n)}(this.configKey,this.configEnv,e).then(function(e){t.$message({message:"配置文件保存成功",type:"success"}),t.loadList(),t.isLoading=!1})},remove:function(){var e=this;this.$confirm("此操作将删除该配置文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){(function(e,t){return s.a.delete(c(e,t))})(e.configKey,e.configEnv).then(function(t){e.$message({message:"配置文件删除成功",type:"success"}),e.loadList(),e.loadConfig()})})}}}),f=(n("ug7J"),n("wUYI"),n("KHd+")),u=Object(f.a)(r,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-container",{staticStyle:{padding:"20px"}},[n("el-main",[n("el-row",{attrs:{gutter:20}},[n("el-col",{attrs:{span:4}},[n("el-select",{attrs:{filterable:"","allow-create":"",placeholder:"请输入配置项"},on:{change:e.envChange},model:{value:e.configKey,callback:function(t){e.configKey=t},expression:"configKey"}},e._l(e.list,function(e){return n("el-option",{key:e,attrs:{label:e,value:e}})}))],1),e._v(" "),n("el-col",{attrs:{span:4}},[n("el-select",{attrs:{placeholder:"请选择环境"},on:{change:e.envChange},model:{value:e.configEnv,callback:function(t){e.configEnv=t},expression:"configEnv"}},e._l(e.envs,function(e){return n("el-option",{key:e,attrs:{label:e,value:e}})}))],1),e._v(" "),n("el-col",{attrs:{span:4}},[n("el-select",{attrs:{placeholder:"请选择编辑模式"},on:{change:e.modeChange},model:{value:e.configMode,callback:function(t){e.configMode=t},expression:"configMode"}},e._l(e.modes,function(e){return n("el-option",{key:e,attrs:{label:e,value:e}})}))],1)],1),e._v(" "),n("el-row",[n("el-col",{attrs:{span:16}},[n("div",{attrs:{id:"jsoneditor"}})])],1),e._v(" "),n("el-row",[n("el-button",{attrs:{disabled:!e.saveStatus,type:"primary"},on:{click:e.save}},[e._v("保存配置")]),e._v(" "),n("el-button",{attrs:{disabled:!e.saveStatus,type:"danger"},on:{click:e.remove}},[e._v("删除配置")])],1)],1)],1)},[],!1,null,"8bec2b06",null);u.options.__file="index.vue";t.default=u.exports},L83s:function(e,t,n){},eZ6N:function(e,t,n){},ug7J:function(e,t,n){"use strict";var o=n("eZ6N");n.n(o).a},wUYI:function(e,t,n){"use strict";var o=n("L83s");n.n(o).a}}]);